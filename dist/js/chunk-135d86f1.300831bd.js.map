{"version":3,"sources":["webpack:///./node_modules/vuetify/lib/components/VGrid/VSpacer.js","webpack:///./src/components/ParserExcel.vue?5475","webpack:///./node_modules/vuetify/lib/components/VGrid/VContainer.js","webpack:///./src/components/ParserExcel.vue?d8e4","webpack:///src/components/ParserExcel.vue","webpack:///./src/components/ParserExcel.vue?3643","webpack:///./src/components/ParserExcel.vue"],"names":["extend","name","functional","props","id","String","tag","type","default","fluid","Boolean","h","data","children","classes","attrs","Object","keys","filter","key","value","startsWith","domProps","staticClass","class","Array","concat","render","_vm","this","_h","$createElement","_c","_self","_v","_s","parser","title","_l","e","idx","model","callback","$$v","success_parse","expression","orig_name","on","$event","change","staticStyle","preventDefault","cancel","_e","preload_data","length","loaded_filename","all_fields_selected","f","k","description","directives","rawName","$$selectedVal","prototype","call","target","options","o","selected","map","val","_value","$set","multiple","v","d","load","col","i","parseInt","_q","data_line_number","j","staticRenderFns","src","uploading","first_header","errors","$http","post","BackendBase","params","config","action","then","r","success","fields","catch","watch","methods","file","document","getElementById","files","reader","FileReader","readAsDataURL","onload","result","preload","calc_first_header","tmp_file","remove_tmp","reset","arr","a","push","computed","component","VApp","VBtn","VCard","VCardActions","VCardText","VCardTitle","VContainer","VDialog","VProgressLinear","VSpacer"],"mappings":"2IAAA,0BAEe,sBAAuB,SAAU,MAAO,a,oCCFvD,yBAA6d,EAAG,G,kCCAhe,gDAMe,sBAAK,aAAaA,OAAO,CACtCC,KAAM,cACNC,YAAY,EACZC,MAAO,CACLC,GAAIC,OACJC,IAAK,CACHC,KAAMF,OACNG,QAAS,OAEXC,MAAO,CACLF,KAAMG,QACNF,SAAS,IAIb,OAAOG,GAAG,MACRR,EAAK,KACLS,EAAI,SACJC,IAEA,IAAIC,EACJ,MAAM,MACJC,GACEH,EA0BJ,OAxBIG,IAEFH,EAAKG,MAAQ,GACbD,EAAUE,OAAOC,KAAKF,GAAOG,OAAOC,IAGlC,GAAY,SAARA,EAAgB,OAAO,EAC3B,MAAMC,EAAQL,EAAMI,GAGpB,OAAIA,EAAIE,WAAW,UACjBT,EAAKG,MAAMI,GAAOC,GACX,GAGFA,GAA0B,kBAAVA,KAIvBjB,EAAMC,KACRQ,EAAKU,SAAWV,EAAKU,UAAY,GACjCV,EAAKU,SAASlB,GAAKD,EAAMC,IAGpBO,EAAER,EAAMG,IAAK,eAAUM,EAAM,CAClCW,YAAa,YACbC,MAAOC,MAAM,CACX,mBAAoBtB,EAAMM,QACzBiB,OAAOZ,GAAW,MACnBD,O,yCC5DR,IAAIc,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,QAAQ,CAACA,EAAG,cAAc,CAACA,EAAG,SAAS,CAACT,YAAY,gBAAgB,CAACS,EAAG,KAAK,CAACjB,MAAM,CAAC,MAAQ,YAAY,CAACa,EAAIM,GAAGN,EAAIO,GAAGP,EAAIQ,OAAOC,UAAUT,EAAIU,GAAIV,EAAU,QAAE,SAASW,EAAEC,GAAK,OAAOR,EAAG,MAAM,CAACb,IAAI,MAAMqB,EAAIjB,YAAY,OAAO,CAACK,EAAIM,GAAGN,EAAIO,GAAGI,SAAQP,EAAG,WAAW,CAACjB,MAAM,CAAC,YAAY,OAAO0B,MAAM,CAACrB,MAAOQ,EAAiB,cAAEc,SAAS,SAAUC,GAAMf,EAAIgB,cAAcD,GAAKE,WAAW,kBAAkB,CAACb,EAAG,SAAS,CAACA,EAAG,eAAe,CAACT,YAAY,YAAY,CAACK,EAAIM,GAAG,eAAeF,EAAG,cAAc,CAACJ,EAAIM,GAAG,YAAYN,EAAIO,GAAGP,EAAIkB,WAAW,sCAAsCd,EAAG,iBAAiB,CAACA,EAAG,YAAYA,EAAG,QAAQ,CAACjB,MAAM,CAAC,MAAQ,WAAWgC,GAAG,CAAC,MAAQ,SAASC,GAAQpB,EAAIgB,eAAgB,KAAS,CAAChB,EAAIM,GAAG,uDAAuD,IAAI,IAAI,GAAGF,EAAG,OAAO,CAACjB,MAAM,CAAC,GAAK,mBAAmB,CAACiB,EAAG,MAAM,CAACA,EAAG,QAAQ,CAACjB,MAAM,CAAC,KAAO,OAAO,GAAK,kBAAkBgC,GAAG,CAAC,OAASnB,EAAIqB,YAAarB,EAAO,IAAEI,EAAG,MAAM,CAACkB,YAAY,CAAC,aAAa,SAAS,CAAClB,EAAG,IAAI,CAACjB,MAAM,CAAC,KAAO,IAAIgC,GAAG,CAAC,MAAQ,SAASC,GAAgC,OAAxBA,EAAOG,iBAAwBvB,EAAIwB,OAAOJ,MAAW,CAACpB,EAAIM,GAAG,gBAAgBN,EAAIyB,OAAQzB,EAAI0B,aAAaC,QAAU3B,EAAI4B,gBAAiBxB,EAAG,MAAM,CAACT,YAAY,WAAW,CAAGK,EAAI6B,oBAAmM7B,EAAIyB,KAAlLrB,EAAG,MAAM,CAACT,YAAY,gBAAgB,CAACK,EAAIM,GAAG,gIAAyIF,EAAG,QAAQ,CAACT,YAAY,eAAeK,EAAIU,GAAIV,EAAIQ,OAAa,QAAE,SAASsB,EAAEC,GAAG,OAAO3B,EAAG,KAAK,CAACb,IAAI,QAAQwC,GAAG,CAAC3B,EAAG,KAAK,CAACJ,EAAIM,GAAGN,EAAIO,GAAGuB,EAAEE,gBAAgB5B,EAAG,KAAK,CAACA,EAAG,SAAS,CAAC6B,WAAW,CAAC,CAAC5D,KAAK,QAAQ6D,QAAQ,UAAU1C,MAAOsC,EAAU,SAAEb,WAAW,eAAeE,GAAG,CAAC,OAAS,SAASC,GAAQ,IAAIe,EAAgBtC,MAAMuC,UAAU9C,OAAO+C,KAAKjB,EAAOkB,OAAOC,SAAQ,SAASC,GAAG,OAAOA,EAAEC,YAAWC,KAAI,SAASF,GAAG,IAAIG,EAAM,WAAYH,EAAIA,EAAEI,OAASJ,EAAEhD,MAAM,OAAOmD,KAAO3C,EAAI6C,KAAKf,EAAG,WAAYV,EAAOkB,OAAOQ,SAAWX,EAAgBA,EAAc,OAAO,CAAC/B,EAAG,SAAS,CAACjB,MAAM,CAAC,MAAQ,MAAM,CAACa,EAAIM,GAAG,sBAAsBN,EAAIU,GAAIV,EAAgB,cAAE,SAASjB,GAAG,OAAOqB,EAAG,SAAS,CAACb,IAAIR,EAAEgE,EAAErD,SAAS,CAAC,MAAQX,EAAEgE,IAAI,CAAC/C,EAAIM,GAAGN,EAAIO,GAAGxB,EAAEiE,UAAS,GAAKhD,EAAI6B,oBAA4J7B,EAAIyB,KAA3I,CAAEK,EAAEW,UAAU,EAAGrC,EAAG,MAAM,CAACT,YAAY,YAAY,CAACK,EAAIM,GAAG,aAAaF,EAAG,MAAM,CAACT,YAAY,gBAAgB,CAACK,EAAIM,GAAG,kBAA2B,QAAO,GAAIN,EAAuB,oBAAEI,EAAG,MAAM,CAACkB,YAAY,CAAC,MAAQ,QAAQ,cAAc,SAAS,CAAEtB,EAAoB,iBAAEI,EAAG,MAAM,CAACT,YAAY,YAAY,CAACK,EAAIM,GAAG,iGAAiGF,EAAG,MAAOJ,EAAuB,oBAAEI,EAAG,QAAQ,CAACjB,MAAM,CAAC,MAAQ,GAAG,MAAQ,WAAWgC,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOpB,EAAIiD,UAAU,CAACjD,EAAIM,GAAG,eAAeN,EAAIyB,MAAM,GAAGrB,EAAG,MAAM,CAACT,YAAY,gBAAgB,CAACK,EAAIM,GAAG,gHAAgHN,EAAIyB,OAAOrB,EAAG,MAAM,CAACT,YAAY,WAAW,CAACK,EAAIM,GAAG,qEAAsEN,EAAa,UAAEI,EAAG,oBAAoB,CAACjB,MAAM,CAAC,MAAQ,UAAU,cAAgB,GAAG,QAAU,GAAG,OAAS,OAAOa,EAAIyB,KAAKrB,EAAG,MAAOJ,EAAI0B,aAAaC,QAAU3B,EAAI4B,gBAAiBxB,EAAG,KAAK,CAACJ,EAAIM,GAAG,+BAA+BN,EAAIyB,KAAKrB,EAAG,QAAQ,CAACT,YAAY,WAAWK,EAAIU,GAAIV,EAAgB,cAAE,SAASkD,EAAIC,GAAG,OAAO/C,EAAG,KAAK,CAACb,IAAI,MAAM4D,GAAG,CAAC/C,EAAG,KAAK,CAAK,GAAH+C,EAAM,CAACnD,EAAIM,GAAG,WAAWF,EAAG,QAAQ,CAAC6B,WAAW,CAAC,CAAC5D,KAAK,QAAQ6D,QAAQ,UAAU1C,MAAOQ,EAAoB,iBAAEiB,WAAW,qBAAqB9B,MAAM,CAAC,KAAO,SAASO,SAAS,CAAC,MAAQ0D,SAASD,GAAG,QAAUnD,EAAIqD,GAAGrD,EAAIsD,iBAAiBF,SAASD,KAAKhC,GAAG,CAAC,OAAS,SAASC,GAAQpB,EAAIsD,iBAAiBF,SAASD,QAAQ,GAAGnD,EAAIU,GAAG,GAAM,SAASqC,EAAEQ,GAAG,OAAOnD,EAAG,KAAK,CAACb,IAAI,MAAMgE,GAAG,CAACvD,EAAIM,GAAGN,EAAIO,GAAGwC,UAAS,MAAK,IAAI,IAAI,IAAI,IAC5zHS,EAAkB,GCmGP,GACPjF,MAAM,CAAC,UACPS,KAAM,KAAM,CACVkC,UAAU,GACVuC,IAAI,GACJC,WAAW,EACXJ,kBAAkB,EAClB9C,OAAO,GAEPkB,aAAa,GACbiC,aAAa,GACb/B,gBAAgB,GAChBZ,eAAc,EACd4C,OAAO,KAGT,YAGA,UACE3D,KAAK4D,MAAMC,KACTC,YAAY,iBAAiB9D,KAAK+D,OAAOC,OACzC,CACEC,OAAO,SAETC,KACAC,IACE,IAAIpB,EAAEoB,EAAEpF,KACR,GAAGgE,EAAEqB,QAAQ,CACX,IAAI,IAAIvC,KAAKkB,EAAExC,OAAO8D,OACpBxC,EAAEW,SAAS,KAEbxC,KAAKO,OAAOwC,EAAExC,UAGlB+D,MACA5D,IAAKV,KAAK2D,OAAO,CAACjD,MAGtB6D,MAAM,CACJ,cAAczB,GACRA,GACF9C,KAAKuB,WAIXiD,QAAS,CACP,SACExE,KAAKyD,WAAU,EACf,IAAIgB,EAAOC,SAASC,eAAe,kBAAkBC,MAAM,GACvDC,EAAS,IAAIC,WACjBD,EAAOE,cAAcN,GACrBI,EAAOG,OAAUtE,IACfV,KAAKiB,UAAUwD,EAAKrG,KACpB4B,KAAKwD,IAAI9C,EAAE2B,OAAO4C,OAClBjF,KAAKkF,YAGT,UACElF,KAAK4D,MAAMC,KACTC,YAAY,iBAAiB9D,KAAK+D,OAAOC,OACzC,CACEC,OAAO,UACPT,IAAKxD,KAAKwD,IACVvC,UAAUjB,KAAKiB,YAEjBiD,KACAC,IACE,IAAIpB,EAAEoB,EAAEpF,KACRiB,KAAKyD,WAAU,EACZV,EAAEqB,UACHpE,KAAKyB,aAAasB,EAAEhE,KAAMiB,KAAK2B,gBAAgBoB,EAAEpB,gBACjD3B,KAAKmF,qBAEPnF,KAAK2D,OAAOZ,EAAEY,SAEhBW,MACA5D,IACEV,KAAKyD,WAAU,EACfzD,KAAK2D,OAAO,CAACjD,MAGnB,SACEV,KAAKwD,IAAI,GAAIxD,KAAKiB,UAAU,GAAIjB,KAAKqD,kBAAiB,EAAOrD,KAAKyB,aAAa,GAC/E,IAAI2D,EAASpF,KAAK2B,gBAElB,GADA3B,KAAKqF,WAAWD,GACbpF,KAAKO,OAAO8D,OACb,IAAI,IAAIxC,KAAK7B,KAAKO,OAAO8D,OACvBxC,EAAEW,UAAU,EAEhBkC,SAASC,eAAe,kBAAkBW,SAE5C,WAAWF,GACNA,GACDpF,KAAK4D,MAAMC,KACTC,YAAY,iBAAiB9D,KAAK+D,OAAOC,OACzC,CACEC,OAAO,kBACPmB,SAASA,IAEXlB,KACAC,IACQA,EAAEpF,QAMhB,OACEiB,KAAKyD,WAAU,EACfzD,KAAK4D,MAAMC,KACTC,YAAY,iBAAiB9D,KAAK+D,OAAOC,OACzC,CACEC,OAAO,OACPtC,gBAAgB3B,KAAK2B,gBACrB0B,iBAAkBrD,KAAKqD,iBACvBgB,OAAOrE,KAAKO,OAAO8D,SAErBH,KAAKC,IACL,IAAIpB,EAAEoB,EAAEpF,KACRiB,KAAKyD,WAAU,EACZV,EAAEqB,UACHpE,KAAKe,eAAc,GAErBf,KAAK2D,OAAOZ,EAAEY,SACbW,MACD5D,IACEV,KAAKyD,WAAU,EAAOzD,KAAK2D,OAAO,CAACjD,MAIzC,oBACE,IAAI6E,EAAI,GACR,IAAIvF,KAAKyB,eAAiBzB,KAAKyB,aAAaC,OAC1C,OACF,IAAI4B,EAAE,EACN,IAAI,IAAIkC,KAAKxF,KAAKyB,aAAa,GAC7B8D,EAAIE,KAAK,CAAC3C,EAAEQ,EAAEP,EAAEyC,IAChBlC,IAEFtD,KAAK0D,aAAa6B,IAItBG,SAAS,CACP,sBACE,IAAI1F,KAAKO,OAAO8D,OACd,OAAO,EAGT,IAAI,IAAIxC,KAAK7B,KAAKO,OAAO8D,OACvB,GAAGxC,EAAEW,SAAS,EACZ,OAAO,EAEX,OAAO,KC9PiL,I,6ICQhMmD,EAAY,eACd,EACA7F,EACAyD,GACA,EACA,KACA,KACA,MAIa,aAAAoC,EAAiB,QAchC,IAAkBA,EAAW,CAACC,OAAA,KAAKC,OAAA,KAAKC,QAAA,KAAMC,aAAA,OAAaC,UAAA,OAAUC,WAAA,OAAWC,aAAA,KAAWC,UAAA,KAAQC,kBAAA,KAAgBC,UAAA","file":"js/chunk-135d86f1.300831bd.js","sourcesContent":["import \"../../../src/components/VGrid/_grid.sass\";\nimport { createSimpleFunctional } from '../../util/helpers';\nexport default createSimpleFunctional('spacer', 'div', 'v-spacer');\n//# sourceMappingURL=VSpacer.js.map","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParserExcel.vue?vue&type=style&index=0&scope=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParserExcel.vue?vue&type=style&index=0&scope=true&lang=css&\"","import \"../../../src/components/VGrid/_grid.sass\";\nimport \"../../../src/components/VGrid/VGrid.sass\";\nimport Grid from './grid';\nimport mergeData from '../../util/mergeData';\n/* @vue/component */\n\nexport default Grid('container').extend({\n  name: 'v-container',\n  functional: true,\n  props: {\n    id: String,\n    tag: {\n      type: String,\n      default: 'div'\n    },\n    fluid: {\n      type: Boolean,\n      default: false\n    }\n  },\n\n  render(h, {\n    props,\n    data,\n    children\n  }) {\n    let classes;\n    const {\n      attrs\n    } = data;\n\n    if (attrs) {\n      // reset attrs to extract utility clases like pa-3\n      data.attrs = {};\n      classes = Object.keys(attrs).filter(key => {\n        // TODO: Remove once resolved\n        // https://github.com/vuejs/vue/issues/7841\n        if (key === 'slot') return false;\n        const value = attrs[key]; // add back data attributes like data-test=\"foo\" but do not\n        // add them as classes\n\n        if (key.startsWith('data-')) {\n          data.attrs[key] = value;\n          return false;\n        }\n\n        return value || typeof value === 'string';\n      });\n    }\n\n    if (props.id) {\n      data.domProps = data.domProps || {};\n      data.domProps.id = props.id;\n    }\n\n    return h(props.tag, mergeData(data, {\n      staticClass: 'container',\n      class: Array({\n        'container--fluid': props.fluid\n      }).concat(classes || [])\n    }), children);\n  }\n\n});\n//# sourceMappingURL=VContainer.js.map","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-app',[_c('v-container',[_c('v-card',{staticClass:\"mx-auto auth\"},[_c('h1',{attrs:{\"color\":\"primary\"}},[_vm._v(_vm._s(_vm.parser.title))]),_vm._l((_vm.errors),function(e,idx){return _c('div',{key:'err'+idx,staticClass:\"err\"},[_vm._v(_vm._s(e))])}),_c('v-dialog',{attrs:{\"max-width\":\"290\"},model:{value:(_vm.success_parse),callback:function ($$v) {_vm.success_parse=$$v},expression:\"success_parse\"}},[_c('v-card',[_c('v-card-title',{staticClass:\"headline\"},[_vm._v(\"Загрузка \")]),_c('v-card-text',[_vm._v(\"Ваш файл \"+_vm._s(_vm.orig_name)+\" был успешно загружен на сервер!\")]),_c('v-card-actions',[_c('v-spacer'),_c('v-btn',{attrs:{\"color\":\"primary\"},on:{\"click\":function($event){_vm.success_parse = false}}},[_vm._v(\"\\n                      ОК\\n                    \")])],1)],1)],1),_c('form',{attrs:{\"id\":\"parse_xls_form\"}},[_c('div',[_c('input',{attrs:{\"type\":\"file\",\"id\":\"parse_xls_file\"},on:{\"change\":_vm.change}})]),(_vm.src)?_c('div',{staticStyle:{\"margin-top\":\"10px\"}},[_c('a',{attrs:{\"href\":\"\"},on:{\"click\":function($event){$event.preventDefault();return _vm.cancel($event)}}},[_vm._v(\"отменить\")])]):_vm._e()]),(_vm.preload_data.length && _vm.loaded_filename)?_c('div',{staticClass:\"comment\"},[(!_vm.all_fields_selected)?_c('div',{staticClass:\"not_selected\"},[_vm._v(\"\\n                  Файл загружен на сервер, для того, чтобы продолжить -- выберите соответствие колонок\\n                \")]):_vm._e(),_c('table',{staticClass:\"select_cols\"},_vm._l((_vm.parser.fields),function(f,k){return _c('tr',{key:'field'+k},[_c('td',[_vm._v(_vm._s(f.description))]),_c('td',[_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(f.selected),expression:\"f.selected\"}],on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.$set(f, \"selected\", $event.target.multiple ? $$selectedVal : $$selectedVal[0])}}},[_c('option',{attrs:{\"value\":\"n\"}},[_vm._v(\"выберите столбец\")]),_vm._l((_vm.first_header),function(h){return _c('option',{key:h.v,domProps:{\"value\":h.v}},[_vm._v(_vm._s(h.d))])})],2),(!_vm.all_fields_selected)?[(f.selected>=0)?_c('div',{staticClass:\"selected\"},[_vm._v(\"выбрано\")]):_c('div',{staticClass:\"not_selected\"},[_vm._v(\"не выбрано\")])]:_vm._e()],2)])}),0),(_vm.all_fields_selected)?_c('div',{staticStyle:{\"color\":\"green\",\"font-weight\":\"bold\"}},[(_vm.data_line_number)?_c('div',{staticClass:\"selected\"},[_vm._v(\"\\n                    Отлично, теперь можно приступить к загрузке файла\\n                    \"),_c('hr'),(_vm.all_fields_selected)?_c('v-btn',{attrs:{\"small\":\"\",\"color\":\"primary\"},on:{\"click\":function($event){return _vm.load()}}},[_vm._v(\"Загрузить\")]):_vm._e()],1):_c('div',{staticClass:\"not_selected\"},[_vm._v(\"Вы выбрали все столбцы. Теперь отметьте слева строку, с которой начинаются данные (заголовок не считаем)\")])]):_vm._e()]):_c('div',{staticClass:\"comment\"},[_vm._v(\"Вы можете загрузить файл в формате xls или xlsx\\n              \")]),(_vm.uploading)?_c('v-progress-linear',{attrs:{\"color\":\"primary\",\"indeterminate\":\"\",\"rounded\":\"\",\"height\":\"6\"}}):_vm._e(),_c('hr'),(_vm.preload_data.length && _vm.loaded_filename)?_c('h2',[_vm._v(\"Предварительный просмотр:\")]):_vm._e(),_c('table',{staticClass:\"preload\"},_vm._l((_vm.preload_data),function(col,i){return _c('tr',{key:'col'+i},[_c('td',[(i==0)?[_vm._v(\"данные\")]:_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.data_line_number),expression:\"data_line_number\"}],attrs:{\"type\":\"radio\"},domProps:{\"value\":parseInt(i),\"checked\":_vm._q(_vm.data_line_number,parseInt(i))},on:{\"change\":function($event){_vm.data_line_number=parseInt(i)}}})],2),_vm._l((col),function(v,j){return _c('td',{key:'col'+j},[_vm._v(_vm._s(v))])})],2)}),0)],2)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-app>\n        <v-container>\n            <v-card class=\"mx-auto auth\"> \n                <h1 color=\"primary\">{{parser.title}}</h1>\n                <div class=\"err\" v-for=\"(e,idx) in errors\" :key=\"'err'+idx\">{{e}}</div>\n                <!-- сообщение об успешной загрузке -->\n                <v-dialog v-model=\"success_parse\" max-width=\"290\">\n                  <v-card>\n                    <v-card-title class=\"headline\">Загрузка </v-card-title>\n                    <v-card-text>Ваш файл {{orig_name}} был успешно загружен на сервер!</v-card-text>\n\n                    <v-card-actions>\n                      <v-spacer></v-spacer>\n                      <v-btn color=\"primary\" @click=\"success_parse = false\">\n                        ОК\n                      </v-btn>\n                    </v-card-actions>\n                  </v-card>\n                </v-dialog>\n                <!-- Форма для загрузки -->\n                <form id=\"parse_xls_form\">\n                  \n                    \n                    <div><input type=\"file\" id=\"parse_xls_file\" @change=\"change\"></div>\n                    <div v-if=\"src\" style=\"margin-top: 10px;\">\n                      <a href=\"\" @click.prevent=\"cancel\">отменить</a>\n                      <!--<a href=\"\" @click.prevent=\"preload\">preload</a>-->\n                    </div>\n                    \n                </form>\n                \n                <div class=\"comment\" v-if=\"preload_data.length && loaded_filename\">\n                  <div v-if=\"!all_fields_selected\" class=\"not_selected\">\n                    Файл загружен на сервер, для того, чтобы продолжить -- выберите соответствие колонок\n                  </div>\n                  <!-- интерактивные надписи в зависимости от того, на каком этапе мы находимся -->\n                  <table class=\"select_cols\">\n                    <tr v-for=\"(f,k) in parser.fields\" :key=\"'field'+k\" >\n                        <td>{{f.description}}</td>\n                        <td>\n                          <select v-model=\"f.selected\">\n                            <option value=\"n\">выберите столбец</option>\n                            <option v-for=\"h in first_header\" :value=\"h.v\" :key=\"h.v\">{{h.d}}</option>\n                          </select>\n                          <template v-if='!all_fields_selected'>\n                            <div v-if=\"f.selected>=0\" class=\"selected\">выбрано</div>\n                            <div v-else class=\"not_selected\">не выбрано</div>\n                          </template>\n                        </td>\n                    </tr>\n                  </table>\n                  <div v-if=\"all_fields_selected\" style=\"color: green; font-weight: bold;\">\n                    <div class=\"selected\" v-if=\"data_line_number\">\n                      Отлично, теперь можно приступить к загрузке файла\n                      <hr>\n                      <v-btn small color=\"primary\" v-if=\"all_fields_selected\" @click=\"load()\">Загрузить</v-btn>\n                    </div>\n                    <div class=\"not_selected\" v-else>Вы выбрали все столбцы. Теперь отметьте слева строку, с которой начинаются данные (заголовок не считаем)</div>\n                  </div>\n                </div>\n                <div v-else class=\"comment\"\n                  >Вы можете загрузить файл в формате xls или xlsx\n                </div>\n                <v-progress-linear\n                  color=\"primary\"\n                  indeterminate\n                  rounded\n                  height=\"6\"\n                  v-if=\"uploading\"\n                />\n                <hr>\n                <h2 v-if=\"preload_data.length && loaded_filename\">Предварительный просмотр:</h2>\n                \n                <table class=\"preload\">\n                  <tr v-for=\"(col,i) in preload_data\" :key=\"'col'+i\">\n\n                    <td>\n                      <template v-if=\"i==0\">данные</template>\n                      <input v-else\n                        type=\"radio\"\n                        v-model=\"data_line_number\"\n                        :value=\"parseInt(i)\"\n                      />\n                    </td>\n\n                    <td v-for=\"(v,j) in  col\" :key=\"'col'+j\">{{v}}</td>\n                    \n                  </tr>\n\n                </table>\n                \n            </v-card>\n          \n        </v-container>\n  </v-app>\n</template>\n\n<script>\n\nexport default {\n        props:['params'],\n        data: () => ({\n          orig_name:'',\n          src:'',\n          uploading: false,\n          data_line_number: false, // первая строка с данными\n          parser:{\n          },\n          preload_data:[],\n          first_header:[],\n          loaded_filename:'',\n          success_parse:false,\n          errors:[]\n        }),\n        \n        mounted () {\n           \n        },\n        created(){\n          this.$http.post(\n            BackendBase+'/parser-excel/'+this.params.config,\n            {\n              action:'init'\n            }\n          ).then(\n            r=>{\n              let d=r.data;\n              if(d.success){\n                for(let f of d.parser.fields){\n                  f.selected='-1'\n                }\n                this.parser=d.parser\n              }\n            }\n          ).catch(\n            e=>{ this.errors=[e]}\n          )\n        },\n        watch:{\n          success_parse(v){\n            if(!v){\n              this.cancel()\n            }\n          }\n        },\n        methods: {\n          change(){\n            this.uploading=true;\n            let file = document.getElementById('parse_xls_file').files[0];\n            let reader = new FileReader();\n            reader.readAsDataURL(file);\n            reader.onload = (e) => {\n              this.orig_name=file.name;\n              this.src=e.target.result;\n              this.preload()\n            }\n          },\n          preload(){ // предварительная загрузка\n            this.$http.post(\n              BackendBase+'/parser-excel/'+this.params.config,\n              {\n                action:'preload',\n                src: this.src,\n                orig_name:this.orig_name\n              }\n            ).then(\n              r=>{\n                let d=r.data;\n                this.uploading=false;\n                if(d.success){\n                  this.preload_data=d.data, this.loaded_filename=d.loaded_filename;\n                  this.calc_first_header();\n                }\n                this.errors=d.errors\n              }\n            ).catch(\n              e=>{\n                this.uploading=false;\n                this.errors=[e]}\n            )\n          },\n          cancel(){\n            this.src='', this.orig_name='', this.data_line_number=false, this.preload_data=[];\n            let tmp_file=this.loaded_filename\n            this.remove_tmp(tmp_file);\n            if(this.parser.fields)\n              for(let f of this.parser.fields)\n                f.selected=-1;\n\n            document.getElementById('parse_xls_form').reset();\n          },\n          remove_tmp(tmp_file){\n            if(tmp_file){\n              this.$http.post(\n                BackendBase+'/parser-excel/'+this.params.config,\n                {\n                  action:'remove_tmp_file',\n                  tmp_file:tmp_file\n                }\n              ).then(\n                r=>{\n                  let d=r.data;\n                  \n                }\n              )\n            }\n          },\n          load(){ // загрузка\n            this.uploading=true;\n            this.$http.post(\n              BackendBase+'/parser-excel/'+this.params.config,\n              {\n                action:'load',\n                loaded_filename:this.loaded_filename,\n                data_line_number: this.data_line_number,\n                fields:this.parser.fields\n              }\n            ).then(r=>{\n              let d=r.data;\n              this.uploading=false;\n              if(d.success){\n                this.success_parse=true;\n              }\n              this.errors=d.errors\n            }).catch(\n              e=>{\n                this.uploading=false; this.errors=[e]\n              }\n            )\n          },\n          calc_first_header(){\n            let arr=[];\n            if(!this.preload_data || !this.preload_data.length)\n              return \n            let j=0;\n            for(let a of this.preload_data[0]){\n              arr.push({v:j,d:a})\n              j++;\n            }\n            this.first_header=arr;\n          },\n\n        },\n        computed:{\n          all_fields_selected(){\n            if(!this.parser.fields)\n              return false \n\n            let flag=1;\n            for(let f of this.parser.fields)\n              if(f.selected<0)\n                return false\n            \n            return true\n          }\n        }\n\n}\n</script>\n\n<style scope>\n  h1 {margin-bottom: 10px;}\n  form {margin-bottom: 10px;}\n  .comment {margin-bottom: 10px; }\n  .v-card {padding: 20px;}\n  table.preload {margin: 10px 0px; border-collapse: collapse; width: 100%;}\n  table.preload td {border: 1px solid gray; padding:  5px;}\n\n  table.select_cols{margin: 10px 0px; border-collapse: collapse; width: 100%;}\n  table.select_cols td {border: 1px solid gray; padding:  5px;}\n  table.select_cols select {min-width: 500px; padding: 5px; border: 1px solid gray;} \n  .selected {color: green; font-weight: bold;}\n  .not_selected {color: red; font-weight: bold;}\n  \n</style>\n\n\n\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParserExcel.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParserExcel.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ParserExcel.vue?vue&type=template&id=024bd3b1&\"\nimport script from \"./ParserExcel.vue?vue&type=script&lang=js&\"\nexport * from \"./ParserExcel.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ParserExcel.vue?vue&type=style&index=0&scope=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VApp } from 'vuetify/lib/components/VApp';\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardActions } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VDialog } from 'vuetify/lib/components/VDialog';\nimport { VProgressLinear } from 'vuetify/lib/components/VProgressLinear';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VApp,VBtn,VCard,VCardActions,VCardText,VCardTitle,VContainer,VDialog,VProgressLinear,VSpacer})\n"],"sourceRoot":""}