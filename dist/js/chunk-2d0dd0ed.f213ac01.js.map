{"version":3,"sources":["webpack:///./src/anna/apt_manager_edit.vue?64dc","webpack:///src/anna/apt_manager_edit.vue","webpack:///./src/anna/apt_manager_edit.vue?d331","webpack:///./src/anna/apt_manager_edit.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","error","login","on","check_login","model","value","callback","$$v","expression","name_f","$event","check_data","name_i","a","name_o","phone","password","preventDefault","gen_pas","_v","ref","set_password","errors","data_ok","save","cancel_edit","_s","edit_form","staticRenderFns","props","apteka","m_name_f","m_name_i","m_name_o","m_phone","m_login","chk_login_cnt","success","methods","f","clear_errors","$http","post","BackendBase","id","m_id","then","r","D","data","length","console","log","manager_id","load_cur_manager_data","catch","component","VBtn","VTextField"],"mappings":"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","file":"js/chunk-2d0dd0ed.f213ac01.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[(_vm.edit_form)?[_c('v-text-field',{attrs:{\"label\":\"Логин\",\"error-messages\":_vm.error.login},on:{\"keyup\":_vm.check_login},model:{value:(_vm.login),callback:function ($$v) {_vm.login=$$v},expression:\"login\"}}),_c('v-text-field',{attrs:{\"label\":\"Фамилия\",\"error-messages\":_vm.error.name_f},on:{\"keyup\":function($event){return _vm.check_data()}},model:{value:(_vm.name_f),callback:function ($$v) {_vm.name_f=$$v},expression:\"name_f\"}}),_c('v-text-field',{attrs:{\"label\":\"Имя\",\"error-messages\":_vm.error.name_i},on:{\"keyup\":function($event){return _vm.check_data(_vm.a)}},model:{value:(_vm.name_i),callback:function ($$v) {_vm.name_i=$$v},expression:\"name_i\"}}),_c('v-text-field',{attrs:{\"label\":\"Отчество\",\"error-messages\":_vm.error.name_o},on:{\"keyup\":function($event){return _vm.check_data()}},model:{value:(_vm.name_o),callback:function ($$v) {_vm.name_o=$$v},expression:\"name_o\"}}),_c('v-text-field',{attrs:{\"label\":\"Телефон\",\"error-messages\":_vm.error.phone},on:{\"keyup\":function($event){return _vm.check_data(_vm.a)}},model:{value:(_vm.phone),callback:function ($$v) {_vm.phone=$$v},expression:\"phone\"}}),(_vm.set_password)?_c('div',[_c('v-text-field',{attrs:{\"label\":\"Задайте пароль\",\"error-messages\":_vm.error.password},on:{\"keyup\":_vm.check_login},model:{value:(_vm.password),callback:function ($$v) {_vm.password=$$v},expression:\"password\"}}),_c('a',{attrs:{\"href\":\"\"},on:{\"click\":function($event){$event.preventDefault();return _vm.gen_pas($event)}}},[_vm._v(\"сгенерировать пароль\")]),_vm._v(\"\\n                     \\n                    \"),_c('v-btn',{ref:\"button\",attrs:{\"color\":\"red\",\"small\":\"\"},on:{\"click\":function($event){_vm.set_password=false}}},[_vm._v(\"Отменить изменение пароля\")])],1):_c('div',[_c('a',{attrs:{\"href\":\"\"},on:{\"click\":function($event){$event.preventDefault();_vm.set_password=1}}},[_vm._v(\"Назначить пароль\")])]),_c('errors',{attrs:{\"errors\":_vm.errors}}),_c('br'),_c('br'),_c('v-btn',{ref:\"button\",attrs:{\"color\":\"primary\",\"small\":\"\",\"disabled\":!_vm.data_ok},on:{\"click\":function($event){return _vm.save()}}},[_vm._v(\"Изменить\")]),_vm._v(\" \\n                  \"),_c('v-btn',{ref:\"button\",attrs:{\"color\":\"red\",\"small\":\"\"},on:{\"click\":_vm.cancel_edit}},[_vm._v(\"Отменить\")])]:[_c('div',[_vm._v(\"Email: \"+_vm._s(_vm.login))]),_c('div',[_vm._v(\"Фамилия: \"+_vm._s(_vm.name_f))]),_c('div',[_vm._v(\"Имя: \"+_vm._s(_vm.name_i))]),_c('div',[_vm._v(\"Отчество: \"+_vm._s(_vm.name_o))]),_c('div',[_vm._v(\"Телефон: \"+_vm._s(_vm.phone))]),_c('v-btn',{ref:\"button\",attrs:{\"color\":\"primary\",\"small\":\"\"},on:{\"click\":function($event){_vm.edit_form=true}}},[_vm._v(\"Изменить\")]),_vm._v(\" \\n            \")],_c('br')],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n\n    \n              <template v-if=\"edit_form\">\n                    <v-text-field \n                              label=\"Логин\"\n                              v-model=\"login\"\n                              :error-messages=\"error.login\" \n                              @keyup=\"check_login\"\n                    />\n                    <v-text-field \n                              label=\"Фамилия\"\n                              v-model=\"name_f\"\n                              :error-messages=\"error.name_f\" \n                              @keyup=\"check_data()\"\n                    />\n                    <v-text-field \n                              label=\"Имя\"\n                              v-model=\"name_i\"\n                              :error-messages=\"error.name_i\" \n                              @keyup=\"check_data(a)\"\n                    />\n                    <v-text-field \n                              label=\"Отчество\"\n                              v-model=\"name_o\"\n                              :error-messages=\"error.name_o\" \n                              @keyup=\"check_data()\"\n                    />\n                    <v-text-field \n                              label=\"Телефон\"\n                              v-model=\"phone\"\n                              :error-messages=\"error.phone\" \n                              @keyup=\"check_data(a)\"\n                    />\n                    <div v-if=\"set_password\">\n                      <v-text-field \n                                label=\"Задайте пароль\"\n                                v-model=\"password\"\n                                :error-messages=\"error.password\" \n                                @keyup=\"check_login\"\n                      />\n                      <!--<v-btn color=\"primary\" ref=\"button\"  @click=\"gen_pas\" small>сгенерировать пароль</v-btn>-->\n                      <a href=\"\" @click.prevent=\"gen_pas\">сгенерировать пароль</a>\n                      &nbsp;\n                      <v-btn color=\"red\" ref=\"button\"  @click=\"set_password=false\" small>Отменить изменение пароля</v-btn>\n\n                    </div>\n                    <div v-else>\n                      <a href=\"\" @click.prevent=\"set_password=1\">Назначить пароль</a>\n                    </div>\n\n                    <errors :errors=\"errors\"/>\n                    <br><br>\n                    <v-btn color=\"primary\" ref=\"button\"  @click=\"save()\" small :disabled=\"!data_ok\">Изменить</v-btn>&nbsp;\n                    <v-btn color=\"red\" ref=\"button\"  @click=\"cancel_edit\" small>Отменить</v-btn>\n                  \n              </template>\n              <template v-else>\n                <div>Email: {{login}}</div>\n                <div>Фамилия: {{name_f}}</div>\n                <div>Имя: {{name_i}}</div>\n                <div>Отчество: {{name_o}}</div>\n                <div>Телефон: {{phone}}</div>\n                <v-btn color=\"primary\" ref=\"button\"  @click=\"edit_form=true\" small>Изменить</v-btn>&nbsp;\n              </template>\n              <br>\n              \n  </div>\n</template>\n<script>\nimport { phone_replace, phone_check, email_check, gen_pas} from '../js/check_func.js';\nexport default ({\n  props:['apteka'],\n  created(){\n    this.name_f=this.apteka.m_name_f\n    this.name_i=this.apteka.m_name_i\n    this.name_o=this.apteka.m_name_o\n    this.phone=this.apteka.m_phone\n    this.login=this.apteka.m_login\n    this.check_login()\n  },\n  data(){\n    return {\n      chk_login_cnt:0,\n      data_ok:true,\n      edit_form:false,\n      success:false,\n      set_password:false,\n      name_f:'',\n      name_i:'',\n      name_o:'',\n      login:'',\n      phone:'',\n      password:'',\n      errors:[],\n      error:{\n        name_f:'',\n        name_i:'',\n        name_o:'',\n        login:'',\n        phone:'',\n      }\n    }\n  },\n  methods:{\n    gen_pas(){\n      this.password=gen_pas()\n    },\n    clear_errors(){\n      this.data_ok=true\n      this.errors=[]\n      for(let f in this.error)\n        this.error[f]=''\n    },\n    check_login(){\n      this.clear_errors()\n      if(!email_check(this.login)){\n        this.error['login']='Логин '+this.login+' должен является валидным адресом электронной почты'\n        this.data_ok=false\n      }\n      else{ // логин прошёл проверку на валидность, проверяем дубли\n        if(this.chk_login_cnt==0){\n \n              this.chk_login_cnt++\n              this.$http.post(\n                BackendBase+'/anna/check-account-login',\n                {\n                  login:this.login,\n                  id: this.apteka.m_id\n                }\n              ).then(\n                r=>{\n                  let D=r.data\n                  this.chk_login_cnt--\n                  if(D.success){\n                    this.check_data()\n                  }\n                  else if(D.errors.length){\n                    this.error['login']=D.errors[0]\n                  }\n                }\n              )\n\n          \n        }\n\n      }\n\n    },\n    check_data(){\n      this.phone=phone_replace(this.phone)\n      // обнуляем ошибки перед проверкой\n      this.clear_errors()\n      \n      \n      if(!phone_check(this.phone)){\n        this.error['phone']='Введите номер телефона в правильном формате'\n        this.data_ok=false\n      }\n\n      if(!this.name_f){\n        this.error['name_f']='укажите фамилию'\n        this.data_ok=false\n      }\n      if(!this.name_i){\n        this.error['name_i']='укажите имя'\n        this.data_ok=false\n      }\n      if(!this.name_o){\n        this.error['name_o']='укажите отчество'\n        this.data_ok=false\n      }\n      if(this.set_password){\n        if(this.password.length<6){\n          this.error['password']='пароль должен быть не менее 6-ти символов'\n        }\n      }\n    },\n    load_cur_manager_data(){\n      this.$http.post(\n        BackendBase+'/anna/get-account-data',\n        {id:this.apteka.m_id}\n      ).then(\n        r=>{\n          let D=r.data\n          if(D.success){\n            D=D.data\n            console.log('D:',D)\n            this.name_f=D.name_f\n            this.name_i=D.name_i\n            this.name_o=D.name_o\n            this.login=D.login\n            this.password=D.password\n          }\n        }\n      )\n    },\n    save(){\n        this.$http.post(\n            BackendBase+'/anna/change-apteka-account',\n            {\n              manager_id:this.apteka.m_id,\n              login:this.login,\n              phone: this.phone,\n              name_f:this.name_f,\n              name_i:this.name_i,\n              name_o:this.name_o,\n              password:(this.set_password && this.password)?this.password:''\n            }\n\n        ).then(\n          r=>{\n            let D=r.data\n            if(D.success){\n              this.success=true\n              this.edit_form=false\n            }\n            else{\n              this.errors=D.errors\n              this.load_cur_manager_data()\n            }\n            \n          }\n        ).catch(()=>{this.load_cur_manager_data()})\n    },\n\n    cancel_edit(){\n      console.log('cancel')\n      this.edit_form=false\n      this.load_cur_manager_data()\n    }\n    \n\n  }\n})\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./apt_manager_edit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./apt_manager_edit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./apt_manager_edit.vue?vue&type=template&id=70d91af3&\"\nimport script from \"./apt_manager_edit.vue?vue&type=script&lang=js&\"\nexport * from \"./apt_manager_edit.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\ninstallComponents(component, {VBtn,VTextField})\n"],"sourceRoot":""}